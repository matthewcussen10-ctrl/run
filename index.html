<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minimalist Running Route App</title>
<style>
    body, html {
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: 'Helvetica Neue', Arial, sans-serif;
        background: #f2f2f2;
        display: flex;
        flex-direction: column;
    }

    #map {
        flex: 1;
        width: 100%;
    }

    #controls {
        position: fixed;
        bottom: 0;
        width: 100%;
        background: #fff;
        box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        padding: 15px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        border-top-left-radius: 15px;
        border-top-right-radius: 15px;
    }

    .control-group {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    label {
        font-size: 0.9rem;
        margin-right: 10px;
    }

    input[type="range"] {
        width: 60%;
    }

    select, button {
        padding: 5px 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        background: #fff;
        cursor: pointer;
    }

    button {
        background: #007bff;
        color: #fff;
        border: none;
        font-weight: bold;
        transition: background 0.2s;
    }

    button:hover {
        background: #0056b3;
    }

    #status {
        font-size: 0.85rem;
        color: #555;
    }
</style>
</head>
<body>
<div id="map"></div>

<div id="controls">
    <div class="control-group">
        <label>Distance (km): <span id="distanceVal">5</span></label>
        <input type="range" id="distance" min="1" max="20" step="0.1" value="5" oninput="distanceVal.innerText=this.value">
    </div>
    <div class="control-group">
        <label>Time (min): <span id="timeVal">30</span></label>
        <input type="range" id="time" min="10" max="180" step="0.1" value="30" oninput="timeVal.innerText=this.value">
    </div>
    <div class="control-group">
        <label>Pace:</label>
        <select id="pace">
            <option value="slow">Slow</option>
            <option value="moderate" selected>Moderate</option>
            <option value="fast">Fast</option>
        </select>
    </div>
    <div class="control-group">
        <label>Terrain:</label>
        <select id="terrain">
            <option value="scenic">Scenic</option>
            <option value="waterside">Waterside</option>
            <option value="hill">Hill</option>
            <option value="road">Road</option>
        </select>
    </div>
    <div class="control-group">
        <label>Return route:</label>
        <select id="returnRoute">
            <option value="same" selected>Same route</option>
            <option value="different">Different route</option>
        </select>
        <button onclick="generateRoute()">Generate Route</button>
    </div>
    <div id="status"></div>
</div>

<script>
let map, directionsService, directionsRenderer, userLocation;

function initMap() {
    map = new google.maps.Map(document.getElementById("map"), {
        zoom: 14,
        center: { lat: -33.8688, lng: 151.2093 } // fallback Sydney
    });

    directionsService = new google.maps.DirectionsService();
    directionsRenderer = new google.maps.DirectionsRenderer({ map: map });

    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            position => {
                userLocation = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };
                map.setCenter(userLocation);
                new google.maps.Marker({
                    position: userLocation,
                    map: map,
                    title: "Your Location"
                });
            },
            () => { document.getElementById("status").innerText = "Geolocation failed."; }
        );
    } else {
        document.getElementById("status").innerText = "Geolocation not supported.";
    }
}

function generateRoute() {
    if (!userLocation) { alert("Waiting for location..."); return; }

    const distanceKm = parseFloat(document.getElementById("distance").value);
    const timeMin = parseFloat(document.getElementById("time").value);
    const pace = document.getElementById("pace").value;
    const terrain = document.getElementById("terrain").value;
    const returnOption = document.getElementById("returnRoute").value;

    // Rough circular route calculation
    const delta = distanceKm / 4 / 111;
    let waypoints = [
        { location: { lat: userLocation.lat + delta, lng: userLocation.lng }, stopover: true },
        { location: { lat: userLocation.lat, lng: userLocation.lng + delta }, stopover: true },
        { location: { lat: userLocation.lat - delta, lng: userLocation.lng }, stopover: true }
    ];

    if (terrain === "waterside") {
        waypoints = waypoints.map(wp => ({ location: { lat: wp.location.lat + 0.001, lng: wp.location.lng + 0.001 }, stopover: true }));
    } else if (terrain === "hill") {
        waypoints = waypoints.map(wp => ({ location: { lat: wp.location.lat + 0.002, lng: wp.location.lng - 0.002 }, stopover: true }));
    } // basic terrain adjustments for demo

    let request = {
        origin: userLocation,
        destination: userLocation,
        travelMode: 'WALKING',
        waypoints: returnOption === "different" ? waypoints : []
    };

    directionsService.route(request, function(result, status) {
        if (status === 'OK') {
            directionsRenderer.setDirections(result);
            document.getElementById("status").innerText = `Route generated: ${distanceKm}km, pace: ${pace}, terrain: ${terrain}`;
        } else {
            alert("Route generation failed: " + status);
        }
    });
}
</script>

<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAPgzqvSqNMXp3jxTLh4TbyT0IwJd46dbA&callback=initMap">
</script>
</body>
</html>
